---
name: wechat-theme-extractor
description: 从微信公众号文章中提取样式，AI 智能分析并生成主题配置
---

# 微信文章主题提取器

**Version:** 3.0.0 (终极简化版)
**Author:** Claude Code
**Target:** markdown-wechat-converter

## 功能描述

从微信公众号文章中提取样式，AI 智能分析并生成主题配置，自动添加到工具中。

## 🎯 设计理念 v3.0

**极致简化，职责分离：**

| 组件 | 职责 | 代码量 |
|------|------|--------|
| **Python 脚本** | 提取 HTML 内容 | ~70 行 |
| **AI 大模型** | 样式分析 + 主题生成 + 写入配置 | - |

## ⚡ v3.0 核心改进

- **Python 只做提取**：获取 HTML → 提取 js_content → 保存文件
- **AI 做所有分析**：直接读取 HTML，无需中间 JSON 格式
- **全自动化**：无需用户交互，一条命令搞定
- **代码精简 70%**：从 215 行 → 70 行

## 工作流程

```
用户提供链接
    ↓
Python 提取内容 (extract.py)
    ├─ curl 获取文章
    ├─ 提取标题
    ├─ 提取 js_content
    └─ 保存到 .extracted_content.html
    ↓
AI 智能分析
    ├─ 读取 HTML 内容
    ├─ 分析样式特征
    ├─ 生成主题配置
    └─ 自动写入 markdown-to-wechat.html
    ↓
完成！主题可用
```

## 使用方法

**只需提供微信文章链接：**

```
wechat-theme-extractor https://mp.weixin.qq.com/s/xxxxx
```

**全程自动，无需任何手动操作。**

## 脚本输出

```
📥 获取微信文章...
✓ 获取成功 (2,593,642 字符)
📝 标题: AI时代，普通人如何实现"一人公司"创业
✂️  提取内容区域...
✓ 提取完成 (50,476 字符)
💾 已保存到: .extracted_content.html

✅ 提取完成！交给 AI 分析...
```

之后 AI 会：
1. 读取提取的 HTML 内容
2. 分析样式（颜色、字号、间距等）
3. 理解文章风格，生成主题名称
4. 创建完整的主题配置
5. 自动更新 markdown-to-wechat.html
6. 输出完成报告

## 提取的样式元素

AI 会自动识别并提取：

- **段落** - 字体大小、行高、间距、颜色
- **标题** - H1/H2/H3 样式、背景、边框
- **列表** - 间距、缩进、符号样式
- **图片** - 边距、圆角、边框
- **代码** - 背景色、字体、高亮
- **引用** - 背景、边框、颜色
- **链接** - 颜色、下划线
- **主题色** - 自动识别主色调

## 文件结构

```
.claude/skills/wechat-theme-extractor/
├── extract.py                    # 提取脚本（70行）
├── markdown-to-wechat.html       # 主工具文件
├── SKILL.md                      # 本文档
└── .extracted_content.html       # 临时文件（自动生成）
```

## 技术栈

- **Python 3** - 内容提取
- **curl** - HTTP 请求
- **Claude AI** - 样式分析和主题生成

## 示例

### 输入

```
https://mp.weixin.qq.com/s/cIxQ9gQg2EJLpJx8ZFxesQ
```

### 输出

```
✅ 主题已成功添加！

主题名称：AI创业清新主题
主题 ID：ai-startup-fresh

风格特点：
  • 主题色：rgb(71, 193, 168) - 清新青绿色
  • 正文：18px，行高 2.0
  • 标题：白色文字 + 青绿背景
  • 整体风格：现代简约

已自动添加到 markdown-to-wechat.html
打开工具即可使用！
```

## 注意事项

1. **需要网络连接** - 用于获取微信文章
2. **自动覆盖** - 每次运行会覆盖 `.extracted_content.html`
3. **主题命名** - AI 会自动避免与现有主题重复

## 维护信息

- **创建时间**：2024-12-19
- **当前版本**：3.0.0
- **最后更新**：2025-12-23
- **维护者**：Claude Code

## 更新日志

### v3.0.0 (2025-12-23) - 终极简化版
- 🔥 **代码精简 70%**：215 行 → 70 行
- ⚡ **Python 只做提取**：不再做样式分析
- 🤖 **AI 全权负责**：分析、生成、写入
- 🗑️ **移除 JSON**：不需要中间数据格式
- 📦 **更简单**：一个脚本搞定提取

### v2.0.0 (2024-12-23) - AI + 工具混合版
- 引入 AI 智能分析
- Python 专注数据提取
- 性能优化 15 倍+

### v1.0.0 (2024-12-19)
- 初始版本
